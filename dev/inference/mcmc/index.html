<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>MCMC · SimulationBasedInference.jl</title><meta name="title" content="MCMC · SimulationBasedInference.jl"/><meta property="og:title" content="MCMC · SimulationBasedInference.jl"/><meta property="twitter:title" content="MCMC · SimulationBasedInference.jl"/><meta name="description" content="Documentation for SimulationBasedInference.jl."/><meta property="og:description" content="Documentation for SimulationBasedInference.jl."/><meta property="twitter:description" content="Documentation for SimulationBasedInference.jl."/><meta property="og:url" content="https://bgroenks96.github.io/SimulationBasedInference.jl/v0/inference/mcmc/"/><meta property="twitter:url" content="https://bgroenks96.github.io/SimulationBasedInference.jl/v0/inference/mcmc/"/><link rel="canonical" href="https://bgroenks96.github.io/SimulationBasedInference.jl/v0/inference/mcmc/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">SimulationBasedInference.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Getting started</span><ul><li><a class="tocitem" href="../../examples/linearode/">Ensemble inversion of a linear ODE</a></li></ul></li><li><span class="tocitem">Problem interface</span><ul><li><a class="tocitem" href="../../problems/observables/">Observables</a></li><li><a class="tocitem" href="../../problems/forward_problem/">Forward problems</a></li><li><a class="tocitem" href="../../problems/inference_problem/">Inference problems</a></li></ul></li><li><span class="tocitem">Inference algorithms</span><ul><li><a class="tocitem" href="../particle/">Partcile sampling</a></li><li class="is-active"><a class="tocitem" href>MCMC</a><ul class="internal"><li><a class="tocitem" href="#DynamicHMC"><span>DynamicHMC</span></a></li><li><a class="tocitem" href="#Turing.jl"><span>Turing.jl</span></a></li><li><a class="tocitem" href="#Gen.jl"><span>Gen.jl</span></a></li></ul></li><li><a class="tocitem" href="../pysbi/">PySBI</a></li></ul></li><li><a class="tocitem" href="../../utils/">Utilities</a></li><li><span class="tocitem">API Reference</span><ul><li><a class="tocitem" href="../../api/sbi/">SimulationBasedInference</a></li><li><a class="tocitem" href="../../api/emulators/">Emulators</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Inference algorithms</a></li><li class="is-active"><a href>MCMC</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>MCMC</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/bgroenks96/SimulationBasedInference.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/bgroenks96/SimulationBasedInference.jl/blob/main/docs/src/inference/mcmc.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="MCMC-inference"><a class="docs-heading-anchor" href="#MCMC-inference">MCMC inference</a><a id="MCMC-inference-1"></a><a class="docs-heading-anchor-permalink" href="#MCMC-inference" title="Permalink"></a></h1><p>Markov Chain Monte Carlo (MCMC) algorithms are generally regarded as the gold-standard of approximate Bayesian inference. However, they are usually not suitable for simulation-based inference problems due to their inefficiency for expensive forward mdoels and high-dimensional parameter spaces. Nevertheless, it is important to benchmark common SBI algorithms against MCMC on reduced-complexity models/problems in order to assess their performance.</p><p><code>SimulationBasedInference</code> does not currently provide direct implementations of any MCMC algorithms. However, the <a href="../../api/sbi/#SimulationBasedInference.MCMC">MCMC</a> type allows MCMC samplers from other Julia packages to be used as inference algorithms for <a href="../../api/sbi/#SimulationBasedInference.SimulatorInferenceProblem">SimulatorInferenceProblem</a>s.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SimulationBasedInference.MCMC-inference-mcmc" href="#SimulationBasedInference.MCMC-inference-mcmc"><code>SimulationBasedInference.MCMC</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">MCMC{algType,stratType,kwargType} &lt;: SimulatorInferenceAlgorithm</code></pre><p>Generic container type for Markov Chain Monte Carlo (MCMC) based inference algorithms.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bgroenks96/SimulationBasedInference.jl/blob/2c220403a46b0b87873a7e1adca1e0c78a110493/src/mcmc/mcmc_base.jl#L1-L5">source</a></section></article><h2 id="DynamicHMC"><a class="docs-heading-anchor" href="#DynamicHMC">DynamicHMC</a><a id="DynamicHMC-1"></a><a class="docs-heading-anchor-permalink" href="#DynamicHMC" title="Permalink"></a></h2><p><a href="https://github.com/tpapp/DynamicHMC.jl">DynamicHMC.jl</a> is a popular Julia package that implements <a href="https://arxiv.org/abs/1701.02434">Hamiltonian Monte Carlo</a>, a gradient-based numerical sampling algorithm. Support for <code>DynamicHMC</code> is provided via an extension module that is automatically loaded when <code>DynamicHMC</code> is installed in the Julia project environment.</p><p>Once installed, the DynamicHMC <code>NUTS</code> algorithm can be used as an inference algorithm in the standard <code>solve</code> interface:</p><pre><code class="language-julia hljs">import DynamicHMC: NUTS

hmc_sol = solve(inference_prob, MCMC(NUTS()), num_samples=5_000, rng=rng)</code></pre><p>or iteratively using <code>init</code>/<code>step!</code>:</p><pre><code class="language-julia hljs"># initialize the sampler; note that this includes the warm-up sampling phase which may take some time
hmc_solver = init(inference_prob, MCMC(NUTS()), num_samples=5_000, rng=rng)
# take one HMC step
step!(hmc_solver)
# run until num_samples is reached
hmc_sol = solve!(hmc_solver)</code></pre><p>Like with other MCMC algorithms, the output of HMC stored in the <code>result</code> field is a <code>Chains</code> object as defined by <a href="https://github.com/TuringLang/MCMCChains.jl">MCMCChains.jl</a>.</p><h2 id="Turing.jl"><a class="docs-heading-anchor" href="#Turing.jl">Turing.jl</a><a id="Turing.jl-1"></a><a class="docs-heading-anchor-permalink" href="#Turing.jl" title="Permalink"></a></h2><p><code>SimulationBasedInference</code> is interoperable with the <a href="https://turinglang.org">Turing</a> probabilistic programming language (PPL). There are two ways one can use <code>Turing</code> with <code>SimulationBasedInference</code> problem:</p><ol><li>To define an arbitrarily complex joint prior for the simulator model parameters (see <a href="../../api/sbi/#SimulationBasedInference.prior">prior</a>)</li><li>As a provider of both MCMC and variational inference (VI) algorithms; note that VI has not yet been tested with <code>SimulationBasedInference</code>.</li></ol><p>An example of (1) would be as follows:</p><pre><code class="language-julia hljs">using Turing
using SimulationBasedInference

@model function myprior(c)
    p ~ Beta(1,1)
    x ~ Normal(0,1)
    return ComponentArray(; p, x, c)
end
</code></pre><p>Note that <strong>the prior model must return an <code>Array</code></strong> of parameters to be passed to the simulator. This array need not correspond to the sample space of the prior; i.e., the returned parameter vector can consist of any arbitrary set of values which may be arbitrary functions of the random variables sampled in the prior model, as well as or its inputs (see the <code>c</code> parameter in the above example).</p><p>The above <code>Turing</code> model can then be transformed into a suitable prior distribution for SBI via the <code>prior</code> method:</p><pre><code class="language-julia hljs">sbi_prior = prior(myprior(1.0))
inference_prob = SimulatorInferenceProblem(forward_prob, sbi_prior, lik)</code></pre><p>where <code>forward_prob</code> and <code>lik</code> correspond to a suitable <a href="../../api/sbi/#SimulationBasedInference.SimulatorForwardProblem">SimulatorForwardProblem</a> and <a href="../../api/sbi/#SimulationBasedInference.SimulatorLikelihood">SimulatorLikelihood</a>.</p><p>To use a <code>Turing</code> sampler for inference, one can simply solve the inference problem again using the <code>MCMC</code> wrapper type, e.g.,</p><pre><code class="language-julia hljs">mh_sol = solve(inference_prob, MCMC(MH(), MCMCSerial()), num_chains=4, num_samples=20_000)</code></pre><p>where <code>MCMCSerial</code> can be replaced with other sampling strategies such as <code>MCMCThreads</code> or <code>MCMCDistributed</code> as described by the <a href="https://turinglang.org/">Turing documentation</a>.</p><h2 id="Gen.jl"><a class="docs-heading-anchor" href="#Gen.jl">Gen.jl</a><a id="Gen.jl-1"></a><a class="docs-heading-anchor-permalink" href="#Gen.jl" title="Permalink"></a></h2><p>TODO</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../particle/">« Partcile sampling</a><a class="docs-footer-nextpage" href="../pysbi/">PySBI »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.12.0 on <span class="colophon-date" title="Thursday 12 June 2025 19:21">Thursday 12 June 2025</span>. Using Julia version 1.9.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
